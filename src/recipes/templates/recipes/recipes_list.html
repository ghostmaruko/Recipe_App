{% extends "recipes/base.html" %} {% load widget_tweaks %} {% block content %}

<div class="d-flex justify-content-between align-items-center mb-4">
  <h1 class="mb-0">All Recipes</h1>
  {% if user.is_authenticated %}
  <a href="{% url 'recipes:create' %}" class="btn btn-success">New Recipe</a>
  {% endif %}
</div>

<!-- Search Bar -->
<div class="mb-4">
  <form method="get" class="row g-3">
    <div class="col-md-6">{{ form.recipe_name|add_class:"form-control" }}</div>
    <div class="col-md-4">{{ form.category|add_class:"form-select" }}</div>
    <div class="col-md-2">
      <button type="submit" class="btn btn-primary w-100">Search</button>
    </div>
  </form>
</div>

<!-- Search Results Table (Pandas) -->
{% if table %}
<div class="mb-5">
  <h2 class="mb-3">Search Results (Table)</h2>
  <div class="table-responsive">{{ table|safe }}</div>
</div>
{% endif %}

<!-- Lista ricette â€“ CARD -->
<div class="row row-cols-1 row-cols-md-3 g-4">
  {% for recipe in recipes %}
  <div class="col">
    <div class="card h-100 shadow-sm recipe-card">
      {% if recipe.image %}
      <a href="{% url 'recipes:detail' recipe.pk %}">
        <img
          src="{{ recipe.image.url }}"
          class="card-img-top recipe-img"
          alt="{{ recipe.name }}"
        />
      </a>
      {% else %}
      <div class="recipe-placeholder"></div>
      {% endif %}

      <div class="card-body text-center">
        <h5 class="card-title mt-2">{{ recipe.name }}</h5>
        {% if recipe.category %}
        <p class="text-muted">{{ recipe.get_category_display }}</p>
        {% endif %}
        <a
          href="{% url 'recipes:detail' recipe.pk %}"
          class="btn btn-primary mt-2"
          >View Recipe</a
        >
      </div>
    </div>
  </div>
  {% empty %}
  <p>No recipes found.</p>
  {% endfor %}
</div>

{% endblock %}
